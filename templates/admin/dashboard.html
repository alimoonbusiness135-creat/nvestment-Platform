{% extends 'admin/base.html' %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<div class="admin-header">
    <h1>Admin Dashboard</h1>
    <p class="text-muted">Welcome to the admin control panel</p>
</div>

<div class="row">
    <div class="col-md-3">
        <div class="statistic-card bg-primary text-white">
            <div class="stat-icon"><i class="fas fa-users"></i></div>
            <h4>Total Users</h4>
            <p class="value">{{ total_users }}</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="statistic-card bg-success text-white">
            <div class="stat-icon"><i class="fas fa-money-bill-wave"></i></div>
            <h4>Total Deposits</h4>
            <p class="value">${{ total_deposit_amount|round(2) }}</p>
            <p class="count">{{ total_deposits }} transactions</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="statistic-card bg-info text-white">
            <div class="stat-icon"><i class="fas fa-hand-holding-usd"></i></div>
            <h4>Total Withdrawals</h4>
            <p class="value">${{ total_withdrawal_amount|round(2) }}</p>
            <p class="count">{{ total_withdrawals }} transactions</p>
        </div>
    </div>
    <div class="col-md-3">
        <div class="statistic-card bg-warning text-white">
            <div class="stat-icon"><i class="fas fa-percentage"></i></div>
            <h4>Net Profit</h4>
            <p class="value">${{ (total_deposit_amount - total_withdrawal_amount)|round(2) }}</p>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header">
                <div class="d-flex justify-content-between align-items-center">
                    <h3 class="mb-0">Pending Requests</h3>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="alert alert-warning">
                            <h4>Pending Deposits</h4>
                            <p class="display-4">{{ pending_deposits }}</p>
                            <a href="{{ url_for('admin_deposits', status='pending') }}" class="btn btn-warning btn-sm mt-2">View All</a>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="alert alert-warning">
                            <h4>Pending Withdrawals</h4>
                            <p class="display-4">{{ pending_withdrawals }}</p>
                            <a href="{{ url_for('admin_withdrawals', status='pending') }}" class="btn btn-warning btn-sm mt-2">View All</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header">
                <h3 class="mb-0">Quick Actions</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-6 col-md-4 mb-3">
                        <a href="{{ url_for('admin_users') }}" class="btn btn-outline-primary btn-block py-3">
                            <i class="fas fa-users fa-2x mb-2"></i><br>
                            Manage Users
                        </a>
                    </div>
                    <div class="col-6 col-md-4 mb-3">
                        <a href="{{ url_for('admin_deposits') }}" class="btn btn-outline-success btn-block py-3">
                            <i class="fas fa-money-bill-wave fa-2x mb-2"></i><br>
                            Manage Deposits
                        </a>
                    </div>
                    <div class="col-6 col-md-4 mb-3">
                        <a href="{{ url_for('admin_withdrawals') }}" class="btn btn-outline-info btn-block py-3">
                            <i class="fas fa-hand-holding-usd fa-2x mb-2"></i><br>
                            Manage Withdrawals
                        </a>
                    </div>
                    <div class="col-6 col-md-4 mb-3">
                        <a href="{{ url_for('admin_notifications') }}" class="btn btn-outline-warning btn-block py-3">
                            <i class="fas fa-bell fa-2x mb-2"></i><br>
                            Send Notifications
                        </a>
                    </div>
                    <div class="col-6 col-md-4 mb-3">
                        <a href="{{ url_for('admin_deleted_accounts') }}" class="btn btn-outline-danger btn-block py-3">
                            <i class="fas fa-user-slash fa-2x mb-2"></i><br>
                            Deleted Accounts
                        </a>
                    </div>
                    <div class="col-6 col-md-4 mb-3">
                        <a href="{{ url_for('dashboard') }}" class="btn btn-outline-secondary btn-block py-3">
                            <i class="fas fa-user-circle fa-2x mb-2"></i><br>
                            User Dashboard
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h3 class="mb-0">Recent Registrations</h3>
            </div>
            <div class="card-body">
                {% if recent_users %}
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Username</th>
                                <th>Email</th>
                                <th>Deposit Balance</th>
                                <th>Earning Balance</th>
                                <th>Registered</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for user in recent_users %}
                            <tr>
                                <td>{{ user.id }}</td>
                                <td>{{ user.username }}</td>
                                <td>{{ user.email }}</td>
                                <td>${{ user.deposit_balance|round(2) }}</td>
                                <td>${{ user.earning_balance|round(2) }}</td>
                                <td>{{ user.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                                <td>
                                    <a href="{{ url_for('admin_user_detail', user_id=user.id) }}" class="btn btn-sm btn-primary">View</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="alert alert-info">No recent registrations.</div>
                {% endif %}
                <div class="text-center mt-3">
                    <a href="{{ url_for('admin_users') }}" class="btn btn-primary">View All Users</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %} 