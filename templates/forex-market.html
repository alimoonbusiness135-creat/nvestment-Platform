{% extends 'base.html' %}

{% block title %}Forex Trading Dashboard - Live Markets{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/forex_dashboard.css') }}">
<style>
    /* Additional tweaks for the specific animation demo context if needed */
    .flash-message-container {
        z-index: 2000;
    }
</style>
{% endblock %}

{% block content %}
<div class="forex-container animate-level-1">
    <!-- TradingView Ticker Tape Widget -->
    <div class="tradingview-widget-container mb-4">
        <div class="tradingview-widget-container__widget"></div>
        <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js"
            async>
                {
                    "symbols": [
                        { "proName": "FOREXCOM:SPX500", "title": "S&P 500" },
                        { "proName": "FOREXCOM:NSX100", "title": "US Tech 100" },
                        { "proName": "FX_IDC:EURUSD", "title": "EUR to USD" },
                        { "proName": "BITSTAMP:BTCUSD", "title": "Bitcoin" },
                        { "proName": "BITSTAMP:ETHUSD", "title": "Ethereum" },
                        { "description": "Gold", "proName": "OANDA:XAUUSD" },
                        { "description": "Solana", "proName": "BINANCE:SOLUSDT" },
                        { "description": "BNB", "proName": "BINANCE:BNBUSDT" }
                    ],
                        "showSymbolLogo": true,
                            "isTransparent": true,
                                "displayMode": "adaptive",
                                    "colorTheme": "light",
                                        "locale": "en"
                }
            </script>
    </div>

    <div class="forex-header">
        <div>
            <h1>Forex Live Markets</h1>
            <p class="text-muted">Real-time professional trading data from TradingView</p>
        </div>
        <div class="market-status">
            <span class="status-dot"></span>
            <span>Market Live (Verified)</span>
        </div>
    </div>

    <!-- TradingView Market Overview Widget -->
    <div class="tradingview-widget-container mb-4" style="height: 600px;">
        <div class="tradingview-widget-container__widget"></div>
        <script type="text/javascript"
            src="https://s3.tradingview.com/external-embedding/embed-widget-market-overview.js" async>
                {
                    "colorTheme": "light",
                        "dateRange": "12M",
                            "showChart": true,
                                "locale": "en",
                                    "width": "100%",
                                        "height": "100%",
                                            "largeChartUrl": "",
                                                "isTransparent": true,
                                                    "showSymbolLogo": true,
                                                        "showFloatingTooltip": true,
                                                            "tabs": [
                                                                {
                                                                    "title": "Forex",
                                                                    "symbols": [
                                                                        { "s": "FX:EURUSD", "d": "EUR to USD" },
                                                                        { "s": "FX:GBPUSD", "d": "GBP to USD" },
                                                                        { "s": "FX:USDJPY", "d": "USD to JPY" },
                                                                        { "s": "FX:USDCHF", "d": "USD to CHF" },
                                                                        { "s": "FX:AUDUSD", "d": "AUD to USD" },
                                                                        { "s": "FX:USDCAD", "d": "USD to CAD" }
                                                                    ],
                                                                    "originalTitle": "Forex"
                                                                },
                                                                {
                                                                    "title": "Crypto",
                                                                    "symbols": [
                                                                        { "s": "BINANCE:BTCUSDT", "d": "Bitcoin" },
                                                                        { "s": "BINANCE:ETHUSDT", "d": "Ethereum" },
                                                                        { "s": "BINANCE:SOLUSDT", "d": "Solana" },
                                                                        { "s": "BINANCE:BNBUSDT", "d": "BNB" },
                                                                        { "s": "BINANCE:XRPUSDT", "d": "XRP" },
                                                                        { "s": "BINANCE:ADAUSDT", "d": "Cardano" }
                                                                    ],
                                                                    "originalTitle": "Crypto"
                                                                },
                                                                {
                                                                    "title": "Commodities",
                                                                    "symbols": [
                                                                        { "s": "CME_MINI:ES1!", "d": "S&P 500" },
                                                                        { "s": "CME:6E1!", "d": "Euro" },
                                                                        { "s": "COMEX:GC1!", "d": "Gold" },
                                                                        { "s": "NYMEX:CL1!", "d": "Crude Oil" },
                                                                        { "s": "NYMEX:NG1!", "d": "Natural Gas" }
                                                                    ],
                                                                    "originalTitle": "Commodities"
                                                                }
                                                            ]
                }
            </script>
    </div>

    <div class="forex-tools">
        <div class="tool-card animate-level-3">
            <h4><i class="fas fa-chart-line"></i> Technical Analysis</h4>
            <div class="tradingview-widget-container">
                <div class="tradingview-widget-container__widget"></div>
                <script type="text/javascript"
                    src="https://s3.tradingview.com/external-embedding/embed-widget-technical-analysis.js" async>
                        {
                            "interval": "1m",
                                "width": "100%",
                                    "isTransparent": true,
                                        "height": "350",
                                            "symbol": "FX:EURUSD",
                                                "showIntervalTabs": true,
                                                    "displayMode": "single",
                                                        "locale": "en",
                                                            "colorTheme": "light"
                        }
                    </script>
            </div>
            <a href="{{ url_for('market_analysis') }}" class="btn btn-outline-primary btn-sm mt-3">Advanced Analysis</a>
        </div>
        <div class="tool-card animate-level-4">
            <h4><i class="fas fa-newspaper"></i> Market News</h4>
            <div class="tradingview-widget-container">
                <div class="tradingview-widget-container__widget"></div>
                <script type="text/javascript"
                    src="https://s3.tradingview.com/external-embedding/embed-widget-timeline.js" async>
                        {
                            "feedMode": "all_symbols",
                                "colorTheme": "light",
                                    "isTransparent": true,
                                        "displayMode": "regular",
                                            "width": "100%",
                                                "height": "350",
                                                    "locale": "en"
                        }
                    </script>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // TradingView widgets are iframe based and handle their own real-time updates.
    // No additional JS simulation required.
    console.log("TradingView Real-time widgets loaded.");
</script>
{% endblock %}